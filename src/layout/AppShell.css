/* src/layout/AppShell.css */

/* =========================
   TOKENS
   ========================= */
:root {
  --bg-0: #05070d;
  --bg-1: #0a1020;
  --bg-2: #0f172a;

  --line: rgba(255, 255, 255, 0.075);
  --text: rgba(229, 231, 235, 0.92);
  --muted: rgba(229, 231, 235, 0.65);

  --glass: rgba(255, 255, 255, 0.06);
  --glass-strong: rgba(255, 255, 255, 0.08);

  --shadow-1: 0 10px 30px rgba(0, 0, 0, 0.42);
  --shadow-2: 0 18px 50px rgba(0, 0, 0, 0.55);

  --accent-mission: #4b87d9;
  --accent-lane: #2aa6d9;
  --accent-load: #7f6bd9;
  --accent-carrier: #2bbf8a;
  --accent-broker: #d6a12b;
  --accent-finance: #d65d77;

  --accent: var(--accent-mission);

  --radius: 14px;

  /* Sidebar sizing */
  --sidebar-w: 240px;

  /* Background intensity */
  --ambient-opacity: 0.85;
  --grid-opacity: 0.18;
  --rings-opacity: 0.50;
  --noise-opacity: 0.10;
  --drift-duration: 70s;

  /* subtle tint per command */
  --tint-a: rgba(255, 255, 255, 0);
  --tint-b: rgba(255, 255, 255, 0);
}

* {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
}

body {
  margin: 0;
  background: var(--bg-0);
  color: var(--text);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
    Helvetica, Arial, sans-serif;
}

/* =========================
   COMMAND ACCENTS
   ========================= */
.app-shell.command-mission {
  --accent: var(--accent-mission);
  --tint-a: rgba(75, 135, 217, 0.1);
  --tint-b: rgba(75, 135, 217, 0.03);
}
.app-shell.command-lane {
  --accent: var(--accent-lane);
  --tint-a: rgba(42, 166, 217, 0.1);
  --tint-b: rgba(42, 166, 217, 0.03);
}
.app-shell.command-load {
  --accent: var(--accent-load);
  --tint-a: rgba(127, 107, 217, 0.1);
  --tint-b: rgba(127, 107, 217, 0.03);
}
.app-shell.command-carrier {
  --accent: var(--accent-carrier);
  --tint-a: rgba(43, 191, 138, 0.1);
  --tint-b: rgba(43, 191, 138, 0.03);
}
.app-shell.command-broker {
  --accent: var(--accent-broker);
  --tint-a: rgba(214, 161, 43, 0.1);
  --tint-b: rgba(214, 161, 43, 0.03);
}
.app-shell.command-finance {
  --accent: var(--accent-finance);
  --tint-a: rgba(214, 93, 119, 0.1);
  --tint-b: rgba(214, 93, 119, 0.03);
}

/* =========================
   APP SHELL BASE
   (IMPORTANT: no black bleed)
   ========================= */
.app-shell {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;

  /* Always paint the viewport */
  background: linear-gradient(135deg, var(--bg-1) 0%, var(--bg-2) 50%, var(--bg-0)
        100%),
    radial-gradient(1200px 760px at 20% 18%, var(--tint-a), transparent 60%),
    radial-gradient(1200px 760px at 78% 82%, var(--tint-b), transparent 62%);
}

/* =========================
   SIDEBAR (off-canvas)
   Desktop: sits over left and we pad main to make room
   Mobile: becomes overlay drawer + scrim
   ========================= */
.sidebar {
  position: absolute;
  top: 0;
  left: 0;
  width: var(--sidebar-w);
  height: 100vh;

  display: flex;
  flex-direction: column;

  background: linear-gradient(
    180deg,
    rgba(6, 10, 18, 0.92) 0%,
    rgba(3, 6, 12, 0.92) 100%
  );
  border-right: 1px solid rgba(255, 255, 255, 0.08);

  transform: translateX(0);
  transition: transform 220ms ease;
  z-index: 40;
  overflow: hidden;
}

/* Fully off-screen. No leftover strip. */
.sidebar.closed {
  transform: translateX(calc(-1 * var(--sidebar-w)));
}

/* subtle internal glow */
.sidebar::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(
    520px 360px at 20% 14%,
    color-mix(in srgb, var(--accent) 22%, transparent),
    transparent 62%
  );
  opacity: 0.16;
}

/* =========================
   MAIN AREA (full paint)
   ========================= */
.app-main {
  position: absolute;
  inset: 0;
  width: 100vw;
  height: 100vh;

  /* background always visible across full screen */
  background: radial-gradient(1200px 780px at 22% 16%, var(--tint-a), transparent
        62%),
    radial-gradient(1200px 820px at 78% 84%, var(--tint-b), transparent 64%);

  overflow: hidden;
  padding: 20px;
}

/* Desktop: make room for sidebar by padding-left (NOT shrinking width) */
.app-shell.sidebar-open .app-main {
  padding-left: calc(var(--sidebar-w) + 20px);
}
.app-shell.sidebar-closed .app-main {
  padding-left: 20px;
}

/* =========================
   FUTURISTIC (non-distracting) LAYERS
   ========================= */
.app-main::before {
  content: "";
  position: absolute;
  inset: -10%;
  pointer-events: none;

  background: radial-gradient(
      900px 620px at 18% 18%,
      color-mix(in srgb, var(--accent) 18%, transparent),
      transparent 66%
    ),
    radial-gradient(900px 650px at 70% 78%, rgba(34, 211, 238, 0.06), transparent
          70%),
    repeating-radial-gradient(
      circle at 60% 52%,
      rgba(255, 255, 255, 0.04) 0px,
      rgba(255, 255, 255, 0.04) 1px,
      transparent 46px,
      transparent 76px
    );

  opacity: var(--ambient-opacity);
  animation: ambient-drift var(--drift-duration) ease-in-out infinite alternate;
}

.app-main::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;

  background: linear-gradient(to right, rgba(255, 255, 255, 0.06) 1px, transparent
        1px),
    linear-gradient(to bottom, rgba(255, 255, 255, 0.06) 1px, transparent 1px);
  background-size: 120px 120px;
  opacity: var(--grid-opacity);
  mask-image: radial-gradient(
    circle at 55% 50%,
    rgba(0, 0, 0, 1) 0%,
    rgba(0, 0, 0, 0.75) 55%,
    rgba(0, 0, 0, 0) 80%
  );
}

@keyframes ambient-drift {
  0% {
    transform: translate3d(0, 0, 0) scale(1);
  }
  50% {
    transform: translate3d(-2%, -1.5%, 0) scale(1.02);
  }
  100% {
    transform: translate3d(2%, 1.5%, 0) scale(1.01);
  }
}

/* Ensure page content sits above the background layers */
.app-main > * {
  position: relative;
  z-index: 1;
}

/* =========================
   SCRIM (click to close)
   Desktop: usually off
   Mobile: on when sidebar open
   ========================= */
.sidebar-scrim {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
  opacity: 0;
  pointer-events: none;
  transition: opacity 180ms ease;
  z-index: 35;
  border: 0;
}

/* =========================
   TOGGLE BUTTON (always visible)
   FIX: when sidebar opens, button moves to the RIGHT of sidebar,
   so it never covers your Day/Night toggle inside the sidebar.
   ========================= */
.sidebar-fab {
  position: absolute;
  top: 14px;
  left: 14px;

  width: 38px;
  height: 34px;
  border-radius: 12px;

  border: 1px solid rgba(255, 255, 255, 0.12);
  background: rgba(255, 255, 255, 0.06);
  color: rgba(255, 255, 255, 0.92);

  cursor: pointer;
  z-index: 60;

  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);

  transition: left 220ms ease, background 160ms ease, box-shadow 160ms ease,
    transform 160ms ease;
}

.sidebar-fab:hover {
  background: rgba(255, 255, 255, 0.09);
  box-shadow: 0 14px 32px rgba(0, 0, 0, 0.35);
  transform: translateY(-1px);
}

/* Desktop open: place button just to the right of sidebar */
.app-shell.sidebar-open .sidebar-fab {
  left: calc(var(--sidebar-w) + 14px);
}

/* =========================
   NIGHT OPS
   ========================= */
html[data-theme="night"] {
  --ambient-opacity: 0.52;
  --grid-opacity: 0.12;
  --drift-duration: 95s;
}

/* =========================
   MOBILE / TABLET BEHAVIOR (better)
   - Sidebar becomes true overlay drawer
   - Main does NOT pad-left
   - Scrim activates when open
   - Toggle button stays top-left (doesn't shift)
   ========================= */
@media (max-width: 980px) {
  :root {
    --sidebar-w: 268px; /* a touch wider on mobile */
  }

  /* Don't push content over on mobile; sidebar overlays */
  .app-shell.sidebar-open .app-main {
    padding-left: 16px;
  }
  .app-shell.sidebar-closed .app-main {
    padding-left: 16px;
  }

  .app-main {
    padding: 16px;
  }

  /* Drawer overlay feel */
  .sidebar {
    z-index: 50;
    box-shadow: 18px 0 60px rgba(0, 0, 0, 0.55);
  }

  /* Scrim on when sidebar is open */
  .app-shell.sidebar-open .sidebar-scrim {
    opacity: 1;
    pointer-events: auto;
  }

  /* Keep the fab in the corner on mobile */
  .app-shell.sidebar-open .sidebar-fab {
    left: 14px;
  }

  /* Make button a bit larger for touch */
  .sidebar-fab {
    width: 44px;
    height: 40px;
    border-radius: 14px;
  }
}

/* Extra small phones */
@media (max-width: 480px) {
  :root {
    --sidebar-w: 86vw;
  }
}
